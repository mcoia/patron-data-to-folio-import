# Patron Importer

This project is a Perl-based application designed to import patron data into a FOLIO system. It uses SQL for data manipulation and storage.

## Features

- Test the system and ensure all Perl modules are installed.
- Scan a specified dropbox directory for patron files.
- Parse the patron files and store the data in a patron table.
- Import the parsed patrons into a FOLIO system using the mod-user-import api.

## Prerequisites

- Perl
- PostgreSQL
- Access to a FOLIO system

## Usage

===== Here are the command line arguments for patron-import

[source, bash]
----
# Test the system and make sure all perl modules are installed.
./patron-import.pl --test

# Scans dropbox for patron files, parses them where they end up in the patron table.
./patron-import.pl --stage

# Import patrons into folio.
./patron-import.pl --import
----

### Test the system

To test the system and ensure all Perl modules are installed, use the following command:

```bash
./patron-import.pl --test
```

### Stage the data

To scan the dropbox for patron files and parse them into the patron table, use the following command:

```bash
./patron-import.pl --stage
```

### Import the data

To import the parsed patrons into the FOLIO system, use the following command:

```bash
./patron-import.pl --import
```



#### Helpful links
https://folio-org.atlassian.net/wiki/spaces/FOLIJET/pages/1380110/MODCFIELDS-39+-+Custom+Field+backend+demo




GRANT ALL PRIVILEGES ON DATABASE foliopatronimport TO foliopatronimport;
GRANT ALL PRIVILEGES ON SCHEMA patron_import TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.login TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.sso_esid_mapping TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.tenant_mapping TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.ptype_mapping TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.institution TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.file_tracker TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.import_response TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.import_failed_users_json TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.folder TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.address TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.mobius_api_user TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.job TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.patron TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.import_failed_users TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.institution_folder_map TO foliopatronimport;
GRANT ALL PRIVILEGES ON patron_import.stage_patron TO foliopatronimport;


GRANT USAGE ON ALL SEQUENCES IN SCHEMA patron_import TO foliopatronimport;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA patron_import TO foliopatronimport;




-- Step 1: Give usage and create on the schema itself
GRANT USAGE, CREATE ON SCHEMA patron_import TO foliopatronimport;

-- Step 2: Give full rights to all existing tables
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA patron_import TO foliopatronimport;

-- Step 3: Give usage rights on all existing sequences
GRANT USAGE, SELECT, UPDATE ON ALL SEQUENCES IN SCHEMA patron_import TO foliopatronimport;

-- Step 4: Ensure future tables also have correct rights
ALTER DEFAULT PRIVILEGES IN SCHEMA patron_import
GRANT ALL ON TABLES TO foliopatronimport;

-- Step 5: Ensure future sequences also have correct rights
ALTER DEFAULT PRIVILEGES IN SCHEMA patron_import
GRANT USAGE, SELECT, UPDATE ON SEQUENCES TO foliopatronimport;
